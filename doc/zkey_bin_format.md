TODO

## zkey format

# Binary format for PIL-FFLONK zkey file

## Summary

This file describes the content of a binary zkey file representing a PIL-FFLONK zkey data.

### General considerations

The standard extension is `.zkey`

### Format of the file

````

     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 4  │   7A 6B 65 79   ┃     Magic  "zkey"
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 4  │   01 00 00 00   ┃       Version 1
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 4  │   07 00 00 00   ┃       Number of Sections
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓   \
     ┃ 4  │ SectionId       ┃  8  │   SectionSize          ┃    \
     ┗━━━━┻━━━━━━━━━━━━━━━━━┻━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━┛     \
                                                                  |
     ┏━━━━━━━━━━━━━━━━━━━━━┓                                      |
     ┃                     ┃                                      |
     ┃                     ┃                                      | Section 1
     ┃                     ┃                                      |
     ┃  Section Content    ┃                                      |
     ┃                     ┃                                      |
     ┃                     ┃                                     /
     ┃                     ┃                                    /
     ┗━━━━━━━━━━━━━━━━━━━━━┛                                   /
     
     ┏━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┓   \
     ┃ 4  │ SectionId       ┃  8  │   SectionSize          ┃    \
     ┗━━━━┻━━━━━━━━━━━━━━━━━┻━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━┛     \
                                                                  |
     ┏━━━━━━━━━━━━━━━━━━━━━┓                                      |
     ┃                     ┃                                      |
     ┃                     ┃                                      | Section 2
     ┃                     ┃                                      |
     ┃  Section Content    ┃                                      |
     ┃                     ┃                                      |
     ┃                     ┃                                     /
     ┃                     ┃                                    /
     ┗━━━━━━━━━━━━━━━━━━━━━┛                                   /
     ...
     ...
     ...
````

#### Magic Number

Size: 4 bytes
The file start with a constant 4 bytes (magic number) "zkey"

```
0x7A 0x6B 0x65 0x79
```

#### Version

Size: 4 bytes
Format: Little-Endian

For this standard it's fixed to

```
0x01 0x00 0x00 0x00
```

#### Number of Sections

Size: 4 bytes
Format: Little-Endian

Number of sections contained in the file, must be 10

#### Section Id

Size: 4 bytes
Format: Little-Endian

Type of the section.

Currently there are 5 types of sections defined:

* 0x00000001 : Header Section
* 0x00000002 : PIL-FFLONK Header Section
* 0x00000003 : F Section
* 0x00000004 : F Commitments Section
* 0x00000005 : Polynomials Map Section
* 0x00000006 : Polynomials Openings Section
* 0x00000007 : Polynomials Names Stage Section
* 0x00000008 : Omegas Section
* 0x00000009 : Powers of Tau Section

If the file contain other types, the format is valid, but they MUST be ignored.

Any order of the sections must be accepted.

#### Section Size

Size: `ws` bytes
Format: Little-Endian

Size in bytes of the section

### Section 1: Header Section

Section Id: 0x01

````
     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 4  │   0C 00 00 00   ┃               Protocol Id: PIL-FFLONK
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
````

### Section 2: PIL_FFLONK Header Section

Section Id: 0x01
````
     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 4  │   20 00 00 00   ┃               Field $F_q$ Size in bytes (fs)
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
     ┃ fs │   010000f0 93f5e143 9170b979 48e83328 5d588181 b64550b8 29a031e1 724e6430 ┃  Q prime
     ┗━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 4  │   20 00 00 00   ┃               Field $F_r$ Size in bytes (fs)
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
     ┃ fs │   010000f0 93f5e143 9170b979 48e83328 5d588181 b64550b8 29a031e1 724e6430 ┃  R prime
     ┗━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 32 │   01 00 00 00   ┃               Circuit Power
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 32 │   01 00 00 00   ┃               Circuit Power with Zero Knowledge
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 32 │   01 00 00 00   ┃               W Power
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━┓
     ┃ 32 │   01 00 00 00   ┃               number of public inputs
     ┗━━━━┻━━━━━━━━━━━━━━━━━┛
     ┏━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
     ┃ 128│   01 00 00 00 00 00 00 00   ┃   X_2
     ┗━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

````

### F Section TODO
### F Commitments Section TODO
### Polynomials Map Section TODO
### Polynomials Openings Section TODO
### Polynomials Names Stage Section TODO
### Omegas Section TODO
### Powers of Tau Section TODO

<!-- ## Backward Compatibility

N.A.

## Test Cases
### Example

Given this r1cs in a 256 bit Field:


$$
\left\{  \begin{array}{rclclcl}
(3w_5 + 8w_6) &\cdot& (2w_0 + 20w_2 + 12w_3) &-& (5w_0 + 7w_2) &=& 0 \\
(4w_1 + 8w_4 + 3w_5) &\cdot& (6w_6 + 44w_3) &&  &=& 0 \\
(4w_6) &\cdot& (6w_0 + 5w_3 + 11s_2) &-& (600w_6) &=& 0
\end{array} \right.
$$

And a Wire to label map.

$$
w_0 := l_0 \\
w_1 := l_3 \\
w_2 := l_{10} \\
w_3 := l_{11} \\
w_4 := l_{12} \\
w_5 := l_{15} \\
w_6 := l_{324} \\
$$

The format will be:

````
     ┏━━━━━━━━━━┓
     ┃ 72316373 ┃       Magic
     ┣━━━━━━━━━━┫
     ┃ 01000000 ┃       Version
     ┣━━━━━━━━━━┫
     ┃ 03000000 ┃       nSections
     ┗━━━━━━━━━━┛
     ┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
     ┃ 01000000 ┃ 40000000 00000000 ┃      SectionId: Header
     ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━┛
        ┏━━━━━━━━━━┓
        ┃ 20000000 ┃    Field Size
        ┣━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ┃ 010000f0 93f5e143 9170b979 48e83328 5d588181 b64550b8 29a031e1 724e6430 ┃
        ┣━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
        ┃ 07000000 ┃    # of wires
        ┣━━━━━━━━━━┫
        ┃ 01000000 ┃    # Public Outs
        ┣━━━━━━━━━━┫
        ┃ 02000000 ┃    # Public Ins
        ┣━━━━━━━━━━┫
        ┃ 03000000 ┃    # Private Ins
        ┣━━━━━━━━━━┻━━━━━━━━┓
        ┃ e8030000 00000000 ┃    # Labels
        ┣━━━━━━━━━━┳━━━━━━━━┛
        ┃ 03000000 ┃    # Constraints
        ┗━━━━━━━━━━┛
     ┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
     ┃ 02000000 ┃ 88020000 00000000 ┃      SectionId: Constraints
     ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━┛
        ┏━━━━━━━━━━┓   Constraint 0: (3w_5 + 8w_6) * (2w_0 + 20w_2 + 12w_3) - (5w_0 + 7w_2) = 0
        ┃ 02000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ┃ 05000000 ┃ 03000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
        ┃ 06000000 ┃ 08000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
        ┏━━━━━━━━━━┓
        ┃ 03000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ┃ 00000000 ┃ 02000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
        ┃ 02000000 ┃ 14000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
        ┃ 03000000 ┃ 0C000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
        ┏━━━━━━━━━━┓
        ┃ 02000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ┃ 00000000 ┃ 05000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
        ┃ 02000000 ┃ 07000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

        ┏━━━━━━━━━━┓   Constraint 1: (4w_1 + 8w_4 + 3w_5) * (6w_6 + 44w_3) = 0
        ┃ 03000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ┃ 01000000 ┃ 04000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
        ┃ 04000000 ┃ 08000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
        ┃ 05000000 ┃ 03000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
        ┏━━━━━━━━━━┓
        ┃ 02000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ┃ 03000000 ┃ 2C000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
        ┃ 06000000 ┃ 06000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
        ┏━━━━━━━━━━┓
        ┃ 00000000 ┃
        ┗━━━━━━━━━━┛

        ┏━━━━━━━━━━┓   Constraint 2: (4w_6) * (6w_0 + 5w_3 + 11w_2) - (600w_6) = 0
        ┃ 01000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ┃ 06000000 ┃ 04000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
        ┏━━━━━━━━━━┓
        ┃ 03000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ┃ 00000000 ┃ 06000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
        ┃ 02000000 ┃ 0B000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
        ┃ 03000000 ┃ 05000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
        ┏━━━━━━━━━━┓
        ┃ 01000000 ┃
        ┣━━━━━━━━━━╋━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ┃ 06000000 ┃ 58020000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ┃
        ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

     ┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
     ┃ 03000000 ┃ 38000000 00000000 ┃      Wire to Label Map
     ┗━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━┛
        ┏━━━━━━━━━━━━━━━━━━━┓
        ┃ 00000000 00000000 ┃
        ┣━━━━━━━━━━━━━━━━━━━┫
        ┃ 03000000 00000000 ┃
        ┣━━━━━━━━━━━━━━━━━━━┫
        ┃ 0a000000 00000000 ┃
        ┣━━━━━━━━━━━━━━━━━━━┫
        ┃ 0b000000 00000000 ┃
        ┣━━━━━━━━━━━━━━━━━━━┫
        ┃ 0c000000 00000000 ┃
        ┣━━━━━━━━━━━━━━━━━━━┫
        ┃ 0f000000 00000000 ┃
        ┣━━━━━━━━━━━━━━━━━━━┫
        ┃ 44010000 00000000 ┃
        ┗━━━━━━━━━━━━━━━━━━━┛
````

And the binary representation in Hex:

````
72316373
01000000
03000000
01000000 40000000 00000000
20000000
010000f0 93f5e143 9170b979 48e83328 5d588181 b64550b8 29a031e1 724e6430
07000000
01000000
02000000
03000000
e8030000 00000000
03000000
02000000 88020000 00000000
02000000
05000000 03000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
06000000 08000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
03000000
00000000 02000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
02000000 14000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
03000000 0C000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
02000000
00000000 05000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
02000000 07000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
03000000
01000000 04000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
04000000 08000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
05000000 03000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
02000000
03000000 2C000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
06000000 06000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000
01000000
06000000 04000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
03000000
00000000 06000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
02000000 0B000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
03000000 05000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
01000000
06000000 58020000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
03000000 38000000 00000000
00000000 00000000
03000000 00000000
0a000000 00000000
0b000000 00000000
0c000000 00000000
0f000000 00000000
44010000 00000000

```` -->

## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).





